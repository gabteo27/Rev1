import{c as Z,I as _,r as m,d as A,j as e,q as u,H as d}from"./index-LcRROtdV.js";import{u as ee,a as se,b as p,H as q,B as o,S as le,C as $,c as F,L as E,I as L,d as ie,T as ae,D as te,e as re,P as D,f as ne,g as oe,h as ce,i as M,j as me,k as ue,l as de,G as pe,m as Ne,F as O,n as he,o as xe,V as be,p as fe}from"./main-B7MzdQVE.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Z("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function we(){var C;const K=ee(),[,H]=se(),{toast:n}=_(),[N,b]=m.useState(!1),[i,c]=m.useState(null),[Q,f]=m.useState(!1),t=parseInt(K.id||"0"),{data:h,isLoading:z}=A({queryKey:["/api/playlists",t],enabled:!!t,retry:!1}),{data:g}=A({queryKey:["/api/content"],retry:!1});m.useEffect(()=>{h&&m.startTransition(()=>{c(h)})},[h]);const y=p({mutationFn:async s=>(await d(`/api/playlists/${t}`,{method:"PUT",body:JSON.stringify(s)})).json(),onSuccess:()=>{n({title:"Playlist actualizada",description:"Los cambios se han guardado correctamente."}),u.invalidateQueries({queryKey:["/api/playlists",t]}),b(!1)},onError:s=>{n({title:"Error",description:s.message||"No se pudo actualizar la playlist.",variant:"destructive"})}}),G=p({mutationFn:async s=>{var r;const l=((r=i==null?void 0:i.items)==null?void 0:r.length)||0;return(await d(`/api/playlists/${t}/items`,{method:"POST",body:JSON.stringify({contentItemId:s,order:l})})).json()},onSuccess:()=>{n({title:"Contenido agregado",description:"El contenido ha sido agregado a la playlist."}),u.invalidateQueries({queryKey:["/api/playlists",t]}),f(!1)},onError:s=>{n({title:"Error",description:s.message||"No se pudo agregar el contenido.",variant:"destructive"})}}),J=p({mutationFn:async({id:s,customDuration:l})=>(await d(`/api/playlist-items/${s}`,{method:"PUT",body:JSON.stringify({customDuration:l})})).json(),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/playlists",t]})}}),j=p({mutationFn:async s=>{await d(`/api/playlist-items/${s}`,{method:"DELETE"})},onSuccess:()=>{n({title:"Elemento eliminado",description:"El elemento ha sido eliminado de la playlist."}),u.invalidateQueries({queryKey:["/api/playlists",t]})},onError:s=>{n({title:"Error",description:s.message||"No se pudo eliminar el elemento.",variant:"destructive"})}}),R=p({mutationFn:async s=>{await d(`/api/playlists/${t}/reorder`,{method:"PUT",body:JSON.stringify({itemOrders:s})})},onSuccess:()=>{u.invalidateQueries({queryKey:["/api/playlists",t]})}}),B=()=>{if(!i.name.trim()){n({title:"Error",description:"El nombre de la playlist es requerido.",variant:"destructive"});return}y.mutate({name:i.name,description:i.description,isActive:i.isActive})},U=s=>{!s.destination||!(i!=null&&i.items)||m.startTransition(()=>{const l=Array.from(i.items),[a]=l.splice(s.source.index,1);l.splice(s.destination.index,0,a);const r=l.map((w,x)=>({id:w.id,order:x}));c({...i,items:l}),R.mutate(r)})},W=(s,l)=>{const a=parseInt(l)||0;a>0&&J.mutate({id:s,customDuration:a})},X=()=>i!=null&&i.items?i.items.reduce((s,l)=>{var a;return s+(l.customDuration||((a=l.contentItem)==null?void 0:a.duration)||0)},0):0,v=s=>{const l=Math.floor(s/60),a=s%60;return l>0?`${l}m ${a}s`:`${a}s`},k=s=>{switch(s){case"image":return e.jsxDEV(fe,{className:"w-5 h-5 text-blue-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:223,columnNumber:16},this);case"video":return e.jsxDEV(be,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:225,columnNumber:16},this);case"pdf":return e.jsxDEV(O,{className:"w-5 h-5 text-purple-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:227,columnNumber:16},this);case"webpage":return e.jsxDEV(xe,{className:"w-5 h-5 text-orange-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:229,columnNumber:16},this);case"text":return e.jsxDEV(he,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:231,columnNumber:16},this);default:return e.jsxDEV(O,{className:"w-5 h-5 text-slate-600"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:233,columnNumber:16},this)}},V=()=>{if(!g||!(i!=null&&i.items))return g||[];const s=i.items.map(l=>l.contentItem.id);return g.filter(l=>!s.includes(l.id))};return z||!i?e.jsxDEV("div",{className:"flex flex-col h-full",children:[e.jsxDEV(q,{title:"Cargando...",subtitle:"Obteniendo información de la playlist"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:247,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 flex items-center justify-center",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:250,columnNumber:13},this),e.jsxDEV("p",{className:"text-slate-600",children:"Cargando playlist..."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:251,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:249,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:248,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:246,columnNumber:7},this):e.jsxDEV("div",{className:"flex flex-col h-full",children:[e.jsxDEV(q,{title:i.name,subtitle:`${((C=i.items)==null?void 0:C.length)||0} elementos • ${v(X())}`,actions:e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(o,{variant:"outline",onClick:()=>H("/playlists"),children:[e.jsxDEV(ge,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:269,columnNumber:15},this),"Volver"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:265,columnNumber:13},this),N?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(o,{variant:"outline",onClick:()=>{b(!1),c(h)},children:"Cancelar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:274,columnNumber:17},this),e.jsxDEV(o,{onClick:B,disabled:y.isPending,children:[e.jsxDEV(le,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:287,columnNumber:19},this),y.isPending?"Guardando...":"Guardar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:283,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:273,columnNumber:15},this):e.jsxDEV(o,{onClick:()=>b(!0),children:"Editar Playlist"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:292,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:264,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:260,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 px-6 py-6 overflow-auto",children:e.jsxDEV("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxDEV($,{children:e.jsxDEV(F,{className:"p-6",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxDEV("div",{children:[e.jsxDEV(E,{htmlFor:"name",children:"Nombre de la Playlist"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:306,columnNumber:19},this),e.jsxDEV(L,{id:"name",value:i.name,onChange:s=>c({...i,name:s.target.value}),disabled:!N},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:307,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:305,columnNumber:17},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(ie,{checked:i.isActive,onCheckedChange:s=>c({...i,isActive:s}),disabled:!N},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:315,columnNumber:19},this),e.jsxDEV(E,{children:"Playlist activa"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:320,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:314,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:304,columnNumber:15},this),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV(E,{htmlFor:"description",children:"Descripción"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:324,columnNumber:17},this),e.jsxDEV(ae,{id:"description",value:i.description||"",onChange:s=>c({...i,description:s.target.value}),disabled:!N,placeholder:"Descripción de la playlist..."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:325,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:323,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:303,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:302,columnNumber:11},this),e.jsxDEV($,{children:[e.jsxDEV("div",{className:"p-6 border-b border-slate-200",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("h3",{className:"text-lg font-semibold text-slate-900",children:"Contenido de la Playlist"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:339,columnNumber:17},this),e.jsxDEV(te,{open:Q,onOpenChange:f,children:[e.jsxDEV(re,{asChild:!0,children:e.jsxDEV(o,{children:[e.jsxDEV(D,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:343,columnNumber:23},this),"Agregar Contenido"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:342,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:341,columnNumber:19},this),e.jsxDEV(ne,{children:[e.jsxDEV(oe,{children:e.jsxDEV(ce,{children:"Agregar Contenido a la Playlist"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:349,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:348,columnNumber:21},this),e.jsxDEV("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:V().length===0?e.jsxDEV("p",{className:"text-center text-slate-500 py-8",children:"No hay contenido disponible para agregar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:353,columnNumber:25},this):V().map(s=>e.jsxDEV("div",{className:"flex items-center p-3 border border-slate-200 rounded-lg hover:border-slate-300 cursor-pointer",onClick:()=>G.mutate(s.id),children:[e.jsxDEV("div",{className:"w-12 h-12 bg-slate-100 rounded-lg mr-3 flex items-center justify-center",children:k(s.type)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:363,columnNumber:29},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("h4",{className:"font-medium text-slate-900",children:s.title},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:367,columnNumber:31},this),e.jsxDEV("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxDEV(M,{variant:"outline",className:"text-xs",children:s.type},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:369,columnNumber:33},this),e.jsxDEV("span",{className:"text-sm text-slate-500",children:v(s.duration||0)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:372,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:368,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:366,columnNumber:29},this)]},s.id,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:358,columnNumber:27},this))},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:351,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:347,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:338,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:337,columnNumber:13},this),e.jsxDEV(F,{className:"p-6",children:!i.items||i.items.length===0?e.jsxDEV("div",{className:"text-center py-12",children:[e.jsxDEV("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsxDEV(D,{className:"w-8 h-8 text-slate-400"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:390,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:389,columnNumber:19},this),e.jsxDEV("h4",{className:"text-lg font-medium text-slate-900 mb-2",children:"Playlist vacía"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:392,columnNumber:19},this),e.jsxDEV("p",{className:"text-slate-600 mb-6",children:"Esta playlist no tiene contenido aún. Agrega elementos para comenzar."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:395,columnNumber:19},this),e.jsxDEV(o,{onClick:()=>f(!0),children:[e.jsxDEV(D,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:399,columnNumber:21},this),"Agregar Contenido"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:398,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:388,columnNumber:17},this):e.jsxDEV(me,{onDragEnd:U,children:e.jsxDEV(ue,{droppableId:"playlist-items",children:s=>e.jsxDEV("div",{...s.droppableProps,ref:s.innerRef,className:"space-y-4",children:[i.items.map((l,a)=>e.jsxDEV(de,{draggableId:l.id.toString(),index:a,children:(r,w)=>{var x,I,P,S,T;return e.jsxDEV("div",{ref:r.innerRef,...r.draggableProps,className:`flex items-center p-4 bg-slate-50 rounded-lg border border-slate-200 hover:border-slate-300 transition-colors ${w.isDragging?"shadow-lg":""}`,children:[e.jsxDEV("div",{...r.dragHandleProps,className:"flex items-center justify-center w-8 h-8 bg-slate-200 rounded cursor-grab mr-4 hover:bg-slate-300",children:e.jsxDEV(pe,{className:"w-4 h-4 text-slate-400"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:430,columnNumber:35},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:426,columnNumber:33},this),e.jsxDEV("div",{className:"w-16 h-12 bg-slate-300 rounded-lg mr-4 flex items-center justify-center",children:k((x=l.contentItem)==null?void 0:x.type)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:433,columnNumber:33},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("h4",{className:"font-medium text-slate-900",children:(I=l.contentItem)==null?void 0:I.title},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:438,columnNumber:35},this),e.jsxDEV("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxDEV(M,{variant:"outline",className:"text-xs",children:(P=l.contentItem)==null?void 0:P.type},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:442,columnNumber:37},this),e.jsxDEV("span",{className:"text-sm text-slate-500",children:v(l.customDuration||((S=l.contentItem)==null?void 0:S.duration)||0)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:445,columnNumber:37},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:441,columnNumber:35},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:437,columnNumber:33},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(L,{type:"number",value:l.customDuration||((T=l.contentItem)==null?void 0:T.duration)||0,onChange:Y=>W(l.id,Y.target.value),className:"w-16 text-center",min:"1"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:452,columnNumber:35},this),e.jsxDEV("span",{className:"text-sm text-slate-500",children:"seg"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:459,columnNumber:35},this),e.jsxDEV(o,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700 p-2",onClick:()=>j.mutate(l.id),disabled:j.isPending,children:e.jsxDEV(Ne,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:467,columnNumber:37},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:460,columnNumber:35},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:451,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:419,columnNumber:31},this)}},l.id,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:413,columnNumber:27},this)),s.placeholder]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:407,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:405,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:404,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:386,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:336,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:301,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:300,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/playlist-detail.tsx",lineNumber:259,columnNumber:5},this)}export{we as default};
